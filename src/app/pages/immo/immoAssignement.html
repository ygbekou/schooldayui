<p-dialog header="Ajout - Affectation" [(visible)]="displayDialog" [responsive]="true" showEffect="fade"
    [modal]="true" width="700">
    <div class="ui-grid ui-grid-responsive ui-fluid" *ngIf="assignement">
        <div>

            <div class="ui-grid-row form-group">
                <div class="ui-grid-col-2">
                    <label i18n="@@file" for="file">Fiche : </label>
                </div>
                <div class="ui-grid-col-9">
                    <p-autoComplete [(ngModel)]="assignement.file" (onDropdownClick)="fileDropdown.handleDropdownClick($event)"
                        [suggestions]="fileDropdown.filteredFiles" [dropdown]="true" id="file"
                        (completeMethod)="fileDropdown.filter($event)" name="file" field="identificationCode"
                        placeholder="Fiche d'Immobilisation" [minLength]="1"></p-autoComplete>
                </div>
                <div class="ui-grid-col-1"></div>
            </div>

            <div class="ui-grid-row form-group">
                <div class="ui-grid-col-2">
                    <label i18n="@@location" for="location">Lieu : </label>
                </div>
                <div class="ui-grid-col-9">
                    <p-autoComplete [(ngModel)]="assignement.location"
                        (onDropdownClick)="locationDropdown.handleDropdownClick($event)"
                        [suggestions]="locationDropdown.filteredLocations" [dropdown]="true" id="location"
                        (completeMethod)="locationDropdown.filter($event)" name="location" field="name"
                        placeholder="Lieu d' affectation" [minLength]="1"></p-autoComplete>
                </div>
                <div class="ui-grid-col-1"></div>
            </div>

            <div class="ui-grid-row form-group">
                <div class="ui-grid-col-2">
                    <label i18n="@@employee" for="employee">Employe : </label>
                </div>
                <div class="ui-grid-col-9">
                    <p-autoComplete [(ngModel)]="assignement.employee"
                        (onDropdownClick)="employeeDropdown.handleDropdownClick($event)"
                        [suggestions]="employeeDropdown.filteredEmployees" [dropdown]="true" id="folder"
                        (completeMethod)="employeeDropdown.filter($event)" name="employee" field="name" placeholder="Detenteur"
                        [minLength]="1"></p-autoComplete>
                </div>
                <div class="ui-grid-col-1"></div>
            </div>
            
            <div class="ui-grid-row form-group">
                <div class="ui-grid-col-2">
                    <label i18n="@@openDate" for="openDate">Date :</label>
                </div>
                <div class="ui-grid-col-9">
                    <p-calendar monthNavigator="true" yearRange="1940:2050" yearNavigator="true" id="openDate" [showIcon]="false"
                        [(ngModel)]="assignement.assignementDate"></p-calendar>
                </div>
                <div class="ui-grid-col-1"></div>
            
            </div>

        </div>
    </div>


    <div *ngIf="error" class="alert alert-danger">{{error}}</div>
    <footer>
        <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
            <button type="button" pButton icon="fa fa-close" (click)="delete()" label="{{DELETE_LABEL}}"></button>
            <button type="button" pButton icon="fa fa-check" (click)="save()" label="{{SAVE_LABEL}}"></button>
        </div>
    </footer>
</p-dialog>


<p-dataTable [value]="assignements" selectionMode="single" [(selection)]="selectedAssignement" expandableRows="true"
    [paginator]="true" [rows]="5" (onRowSelect)="onRowSelect($event)" [responsive]="true">
    <p-column expander="true" styleClass="col-icon" [style]="{'width':'5%'}">

    </p-column>
    <p-column *ngFor="let col of cols" [field]="col.field" [header]="col.header" [sortable]="col.sortable"
        [style]="col.style" [filter]="col.filter">
        <ng-template *ngIf="col.type === 'Date'" let-col let-data="rowData" pTemplate type="body">
            <span class="col-date">{{ data[ col.field ] | date:'dd/MM/yy' }}</span>
        </ng-template>
        <ng-template *ngIf="col.type === 'Raw'" let-col let-data="rowData" pTemplate type="body">
            <span class="col-text" innerHTML="{{ data[ col.field ]}}"></span>
        </ng-template>
    </p-column>

    <ng-template pTemplate="paginatorLeft">
        <button type="button" (click)="showDialogToAdd()" pButton icon="fa fa-plus-circle"></button>
    </ng-template>
    <ng-template pTemplate="paginatorRight">
        <button type="button" (click)="getAll()" pButton icon="fa fa-refresh"></button>
    </ng-template>
</p-dataTable>